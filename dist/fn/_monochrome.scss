/// Returns monochrome color, where index with number 0 is the lightest.
/// @access public
/// @param {color|string} $value - Color, or color-key
/// @param {number} $index - Index in the monochrome scale
/// @param {boolean|string} $desaturate [false] - Desaturate (boolean, black)
/// @param {number} $steps [$const-monochrome-steps] - Number of steps

@function monochrome(
  $value,
  $index,
  $desaturate: false,
  $steps: $const-monochrome-steps
) {
  $color: color($value);

  // Color properties
  $hue: hue($color);
  $saturation: saturation($color);
  $lightness: lightness($color);

  // Set saturation level when desaturate parameter is in use
  @if ($desaturate) {
    $saturation: percentage(1 / 8) - ($steps - $index - 1) * 0.475;

    @if ($desaturate == 'black') {
      $saturation: 0%;
    }
  }

  // Tint: set saturation and lightness with rising index number
  @if ($index < $steps / 2) {
    @if (not $desaturate) {
      $saturation: $lightness * 1.6;
    }

    $edge: (100 - $lightness) / $steps;
    $lightness-step: (100 - $lightness - 2 * $edge) / ($steps / 2);
    $lightness: 100 - $edge - $index * $lightness-step;
  }

  // Shade: set lightness with rising index number
  @else if($index > $steps / 2) {
    $shade-index: $index - $steps / 2;
    $lightness-step: $lightness / ($steps - 1);
    $modifier: 1 - (((0.125 + 1 / $steps) / ($steps / 2)) * $shade-index);
    $lightness: ($lightness - $lightness-step * $shade-index) * $modifier;

    @if ($desaturate == 'black') {
      $lightness: $lightness * 0.85;
    }
  }

  @return hsl($hue, $saturation, $lightness);
}
